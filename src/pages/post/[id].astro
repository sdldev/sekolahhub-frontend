---
import Layout from '../../layouts/Layout.astro';
import { getPosts } from '../../utils/api';

export async function getStaticPaths() {
  const posts = await getPosts();
  return posts.map(post => ({
    params: { id: post.id.toString() },
    props: { post },
  }));
}

const { post } = Astro.props;
const formattedDate = new Date(post.created_at).toLocaleDateString();
---

<Layout title={post.title}>
  <main class="max-w-4xl mx-auto px-4 py-8">
    <article class="prose lg:prose-xl mx-auto">
      {post.image && (
        <img 
          src={post.image} 
          alt={post.title}
          class="w-full h-64 object-cover rounded-lg mb-8"
        />
      )}
      <h1 class="text-4xl font-bold mb-4">{post.title}</h1>
      <p class="text-gray-600 mb-8">{formattedDate}</p>
      <div class="prose prose-lg" set:html={post.content} />
      <a 
        href="/"
        class="inline-block mt-8 text-blue-600 hover:text-blue-800"
      >
        ‚Üê Back to all posts
      </a>
    </article>
  </main>
</Layout>